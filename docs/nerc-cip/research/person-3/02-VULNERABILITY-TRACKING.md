## Task 3.2: Define Vulnerability Assessment Tracking System

**CIP Standard**: CIP-010 R3 (Vulnerability Assessments)
**Estimated Time**: 5-7 hours
**Priority**: HIGH

### Research Objectives

1. Document CIP-010 R3 requirements (15-month vulnerability assessment cycle)
2. Research corporate vulnerability scanning tools (Tenable, Qualys, Rapid7, etc.)
3. Define how MISP will track vulnerabilities affecting ICS/SCADA systems
4. Design workflow for vulnerability disclosure and remediation tracking
5. Research CVE feed integration with MISP

### CIP-010 R3 Requirements Summary

```markdown
# CIP-010 R3 - Vulnerability Assessments

**Requirement**: Perform vulnerability assessments every 15 calendar months

**Scope**: All BES Cyber Systems (Medium Impact)

**Assessment Types**:
1. **Active scanning** - Automated vulnerability scanners (Tenable, Qualys, etc.)
2. **Passive scanning** - Network traffic analysis (Tenable.sc, Dragos, Claroty)
3. **Manual review** - Paper review of ICS vendor advisories

**Compliance Evidence Required**:
- Vulnerability assessment reports dated within last 15 months
- Remediation plan for identified vulnerabilities (or documented risk acceptance)
- Tracking of vulnerability remediation status

**MISP's Role**:
- Track ICS/SCADA vulnerabilities from vendor advisories
- Store assessment results and remediation status
- Provide compliance reporting (when was last assessment? which systems assessed?)
```

### Deliverables

#### 1. Corporate Vulnerability Management Platform Assessment

**Template**: Copy and complete this assessment

```markdown
# Vulnerability Management Platform Assessment

## Current Vulnerability Scanner

**Vendor**: [ ] Tenable Nessus/Security Center  [ ] Qualys VMDR  [ ] Rapid7 InsightVM  [ ] Greenbone  [ ] Other: _______

**Version**: _______________________________

**Administrator Contact**: _______________________________

**Does scanner have network access to ICS environment?**: [ ] Yes  [ ] No  [ ] Partial

**ICS scanning considerations**:
- [ ] We perform active scanning on ICS systems
- [ ] We only do passive scanning on ICS (using network tap)
- [ ] We do manual paper reviews instead of scanning
- [ ] We have separate scanner for IT vs OT environments

## Current Vulnerability Assessment Cycle

**How often do we scan/assess BES Cyber Systems?**:
- [ ] Monthly
- [ ] Quarterly
- [ ] Every 15 months (exactly meeting CIP-010 requirement)
- [ ] Other: _______

**Last vulnerability assessment date**: _______________________________

**Next scheduled assessment date**: _______________________________

**Does this meet 15-month CIP-010 R3 requirement?**: [ ] Yes  [ ] No

## Vulnerability Remediation Tracking

**How do we currently track vulnerability remediation?**:
- [ ] Spreadsheet
- [ ] Ticketing system (ServiceNow, Jira, etc.)
- [ ] Vulnerability scanner's built-in tracking
- [ ] MISP (goal state)
- [ ] Other: _______

**Current remediation SLA**: _______ days (CIP-010 R2 requires 35 days for critical patches)

## ICS Vendor Advisory Tracking

**Do we currently track ICS vendor security advisories?**: [ ] Yes  [ ] No

**Which ICS vendors do we need to monitor?**:
- [ ] Siemens (SIMATIC, SINEC, etc.)
- [ ] Schneider Electric (EcoStruxure, Modicon, etc.)
- [ ] Rockwell Automation (Allen-Bradley, FactoryTalk, etc.)
- [ ] GE Digital (iFix, CIMPLICITY, Proficy)
- [ ] ABB (800xA, Symphony+, etc.)
- [ ] Emerson (DeltaV, Ovation, ROC)
- [ ] SEL (relays, RTUs)
- [ ] Schweitzer Engineering Labs
- [ ] Other: _______________________________

**How do we receive vendor advisories?**:
- [ ] Email subscription
- [ ] ICS-CERT RSS feed
- [ ] Vendor portal (manual check)
- [ ] Not currently tracking (need to implement)
```

#### 2. MISP Vulnerability Tracking Design

Document how MISP will track vulnerabilities:

```markdown
# MISP Vulnerability Tracking Design

## Vulnerability Event Structure

### Event Type: "ICS Vulnerability Disclosure"

**Event Template Fields**:
- **Event Info**: "[CVE-YYYY-####] [Vendor] [Product] - [Vulnerability Title]"
- **Event Date**: Date vulnerability was published
- **Threat Level**: Based on CVSS score (High: 9.0-10.0, Medium: 7.0-8.9, Low: 0.0-6.9)
- **Analysis**:
  - 0 = Initial (just published, no assessment)
  - 1 = Ongoing (assessment in progress)
  - 2 = Complete (remediation plan finalized)
- **Distribution**: Your organization only (CIP-011 BCSI)

### Required Attributes

**Vulnerability Identifiers**:
- CVE ID (e.g., CVE-2024-12345)
- ICS-CERT Advisory ID (e.g., ICSA-24-001-01)
- Vendor Advisory ID (e.g., Siemens SSA-123456)

**Affected Products**:
- Vendor name
- Product name and version (e.g., "Siemens SIMATIC PCS 7 v9.0")
- CPE (Common Platform Enumeration) if available

**Severity**:
- CVSS v3.1 Base Score
- CVSS Vector String
- CVSS Temporal Score (if available)

**Remediation**:
- Patch available? (Yes/No)
- Patch version
- Patch URL
- Workaround available? (text field)

**Internal Tracking** (Custom Attributes):
- Asset inventory check: Do we have affected systems? (Yes/No)
- Number of affected systems
- Remediation status (Not Started / In Progress / Patched / Risk Accepted)
- Remediation due date (35 days from disclosure per CIP-010 R2)
- Ticket ID (link to ServiceNow/Jira ticket)

### Required Tags

- `tlp:amber` (sensitive but shareable within org)
- `cip-010:vulnerability-assessment`
- `cvss-score:high` / `cvss-score:medium` / `cvss-score:low`
- `sector:energy`
- `ics-vendor:[vendor-name]` (e.g., `ics-vendor:siemens`)
- `remediation-status:pending` / `remediation-status:patched` / `remediation-status:risk-accepted`

### Example Event JSON

```json
{
  "Event": {
    "date": "2024-10-15",
    "info": "[CVE-2024-12345] Siemens SIMATIC PCS 7 - Buffer Overflow in Web Server",
    "threat_level_id": "2",
    "analysis": "1",
    "distribution": "0",
    "Attribute": [
      {
        "type": "vulnerability",
        "category": "External analysis",
        "value": "CVE-2024-12345",
        "comment": "Primary CVE identifier"
      },
      {
        "type": "link",
        "category": "External analysis",
        "value": "https://www.cisa.gov/news-events/ics-advisories/icsa-24-001-01",
        "comment": "ICS-CERT Advisory"
      },
      {
        "type": "text",
        "category": "Other",
        "value": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
        "comment": "CVSS Vector - Score: 9.8 CRITICAL"
      },
      {
        "type": "text",
        "category": "Other",
        "value": "Siemens SIMATIC PCS 7 v9.0 SP2",
        "comment": "Affected product and version"
      },
      {
        "type": "link",
        "category": "External analysis",
        "value": "https://support.industry.siemens.com/cs/document/123456",
        "comment": "Vendor patch download"
      },
      {
        "type": "text",
        "category": "Internal reference",
        "value": "Affected systems: 3 HMI workstations at Substation Alpha",
        "comment": "Internal asset inventory check"
      },
      {
        "type": "text",
        "category": "Internal reference",
        "value": "Ticket: INC0012345",
        "comment": "ServiceNow incident ticket"
      },
      {
        "type": "text",
        "category": "Internal reference",
        "value": "Remediation due: 2024-11-19 (35 days)",
        "comment": "CIP-010 R2 compliance deadline"
      },
      {
        "type": "text",
        "category": "Internal reference",
        "value": "Status: In Progress - patch testing in lab environment",
        "comment": "Current remediation status"
      }
    ],
    "Tag": [
      {"name": "tlp:amber"},
      {"name": "cip-010:vulnerability-assessment"},
      {"name": "cvss-score:critical"},
      {"name": "sector:energy"},
      {"name": "ics-vendor:siemens"},
      {"name": "remediation-status:in-progress"}
    ]
  }
}
```

## Vulnerability Assessment Cycle Tracking

MISP can track the 15-month assessment cycle with a scheduled report:

### Dashboard/Report: "CIP-010 R3 Compliance Status"

**Metrics to Display**:

1. **Last Vulnerability Assessment Date**
   - Search for most recent event with tag `cip-010:vulnerability-assessment`
   - Display: "Last assessment: October 15, 2024 (4 months ago)"

2. **Next Assessment Due Date**
   - Calculate: Last assessment + 15 months
   - Display: "Next assessment due: January 15, 2026 (14 months from now)"
   - Status indicator:
     - GREEN: >6 months remaining
     - YELLOW: 3-6 months remaining
     - RED: <3 months remaining (urgent)

3. **Open Vulnerabilities by Severity**
   - CRITICAL (CVSS 9.0-10.0): X vulnerabilities
   - HIGH (CVSS 7.0-8.9): X vulnerabilities
   - MEDIUM (CVSS 4.0-6.9): X vulnerabilities
   - LOW (CVSS 0.1-3.9): X vulnerabilities

4. **Vulnerabilities Past Remediation Deadline**
   - Search for events where "Remediation due date" < today AND status != "Patched"
   - Display: "5 vulnerabilities overdue for remediation (CIP-010 R2 violation)"

5. **Remediation Status Breakdown**
   - Not Started: X
   - In Progress: X
   - Patched: X
   - Risk Accepted: X

## CVE Feed Integration

Research automatic CVE feed ingestion:

**Option 1: CISA ICS-CERT Advisories**
- Feed URL: https://www.cisa.gov/cybersecurity-advisories/ics-advisories
- Format: RSS/XML
- Frequency: As published (several per week)
- MISP sync method: Custom Python script using MISP API

**Option 2: NVD CVE Feed (filtered for ICS)**
- Feed URL: https://services.nvd.nist.gov/rest/json/cves/2.0
- Filter: CPE matches for ICS products
- MISP sync method: PyMISP script with CPE filtering

**Option 3: Commercial ICS Threat Intelligence**
- Dragos WorldView (if licensed)
- Claroty CTD (if licensed)
- Tenable OT Security feed
```

#### 3. Vulnerability Management Workflow

Document the end-to-end workflow:

```markdown
# Vulnerability Management Workflow

## Step 1: Vulnerability Discovered/Published

**Trigger**: ICS-CERT advisory published OR vulnerability scanner finds new CVE

**Actions**:
1. Create MISP event using "ICS Vulnerability Disclosure" template
2. Assign tags: `tlp:amber`, `cip-010:vulnerability-assessment`, CVSS severity
3. Set Analysis = "Initial"

## Step 2: Asset Inventory Check

**Responsible**: IT/OT team

**Actions**:
1. Check asset inventory: Do we have affected systems?
2. Update MISP event with internal reference attributes:
   - "Affected systems: [count] [system types] at [locations]"
   - If not affected: "Affected systems: None - not applicable"
3. If affected, create ticket in ServiceNow/Jira
4. Update MISP event with ticket ID

## Step 3: Risk Assessment

**Responsible**: Security/OT team

**Actions**:
1. Calculate risk: CVSS score + asset criticality + exploitability
2. Determine remediation priority:
   - CRITICAL (CVSS 9-10) + BES Cyber Asset = Immediate (7 days)
   - HIGH (CVSS 7-8.9) + BES Cyber Asset = Urgent (35 days per CIP-010 R2)
   - MEDIUM (CVSS 4-6.9) = Normal (next maintenance window)
   - LOW (CVSS 0-3.9) = Risk accept or next assessment cycle
3. Update MISP event:
   - Set "Remediation due date"
   - Set Analysis = "Ongoing"
   - Add comment with risk assessment justification

## Step 4: Remediation Planning

**Responsible**: OT team + Vendors

**Actions**:
1. Test patch in lab environment (non-production ICS mirror)
2. Coordinate outage window with operations
3. Create detailed change control plan (CAB approval required)
4. Update MISP event:
   - Tag: `remediation-status:in-progress`
   - Add comment: "Patch scheduled for [date] during [outage window]"

## Step 5: Patch Deployment

**Responsible**: OT team

**Actions**:
1. Deploy patch during approved maintenance window
2. Verify system functionality post-patch
3. Update MISP event:
   - Tag: `remediation-status:patched`
   - Add comment: "Patched on [date] - verification successful"
   - Set Analysis = "Complete"

## Step 6: Risk Acceptance (if applicable)

**Responsible**: CIP Compliance Manager + VP Operations

**Actions**:
1. If patch unavailable or too risky to deploy:
   - Document compensating controls (e.g., network segmentation, firewall rules)
   - Obtain formal risk acceptance from management
2. Update MISP event:
   - Tag: `remediation-status:risk-accepted`
   - Add attribute: "Risk acceptance approved by [name] on [date]"
   - Add attribute: "Compensating controls: [description]"
   - Set Analysis = "Complete"

## Step 7: Compliance Reporting

**Responsible**: CIP Compliance Administrator

**Frequency**: Quarterly (before NERC audits)

**Actions**:
1. Generate MISP report: All events tagged `cip-010:vulnerability-assessment` in last 15 months
2. Export to PDF/Excel showing:
   - Vulnerability count by severity
   - Remediation status breakdown
   - Overdue remediation items (CIP-010 R2 violations)
   - Risk acceptances with justification
3. Store report in compliance evidence repository
```

---

